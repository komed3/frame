class VideoUploader{constructor(){this.form=document.querySelector(".frame-upload"),this.dropArea=this.form.querySelector(".frame-upload--file-drop"),this.fileInput=this.dropArea.querySelector("input"),this.preview=this.form.querySelector(".frame-upload--file-preview"),this.video=this.preview.querySelector("video"),this.fileInfo=this.form.querySelector(".frame-upload--file-info"),this.progress=this.form.querySelector(".frame-upload--progress"),this.errorMsg=this.form.querySelector(".frame-upload--error-message"),this.isUploading=!1,this.errorTimeout=null,this.initEventListener()}initEventListener(){this.fileInput.addEventListener("change",this.handleFileSelect.bind(this)),this.preview.querySelector(".change-file").addEventListener("click",this.clearFileSelect.bind(this)),this.form.addEventListener("submit",this.submit.bind(this)),this.form.addEventListener("reset",this.reset.bind(this)),window.addEventListener("beforeunload",(e=>{this.isUploading&&e.preventDefault()}))}handleFileSelect(e){const t=e.target.files[0];t&&t.type.startsWith("video/")&&(this.video.src=URL.createObjectURL(t),this.video.load(),this.dropArea.classList.add("hidden"),this.preview.classList.remove("hidden"),this.fileInfo.querySelector(".name").textContent=t.name,this.fileInfo.querySelector(".size").textContent=formatFileSize(t.size),this.fileInfo.querySelector(".type").textContent=t.type,this.video.addEventListener("loadedmetadata",(()=>{this.fileInfo.querySelector(".duration").textContent=formatTime(this.video.duration),this.fileInfo.querySelector(".resolution").textContent=`${this.video.videoWidth}px × ${this.video.videoHeight}px`})))}clearFileSelect(){this.fileInput.value="",this.video.src="",this.video.load(),this.dropArea.classList.remove("hidden"),this.preview.classList.add("hidden"),this.fileInfo.querySelectorAll("strong").forEach((e=>e.textContent="—"))}showError(e){this.form.classList.remove("processing"),this.form.classList.add("error"),this.errorMsg.textContent=e,clearTimeout(this.errorTimeout),this.errorTimeout=setTimeout((()=>{this.form.classList.remove("processing","error"),this.isUploading=!1}),2500)}submit(e){if(e.preventDefault(),this.isUploading)return;this.isUploading=!0,this.form.classList.add("processing");new FormData(this.form)}reset(){this.clearFileSelect()}}document.addEventListener("DOMContentLoaded",(()=>new VideoUploader));