class VideoSearch{constructor(){this.form=document.querySelector(".frame-search--form"),this.loader=document.querySelector(".frame-search--loader"),this.results=document.querySelector(".frame-search--results-grid"),this.empty=document.querySelector(".frame-search--empty"),this.more=document.querySelector(".frame-search--more"),this.query=null,this.offset=0,this.initEventHandlers()}initEventHandlers(){this.form.addEventListener("submit",this.submit.bind(this)),this.form.querySelectorAll("select").forEach((e=>e.addEventListener("change",this.submit.bind(this))))}async submit(e){e.preventDefault();const t={...Object.fromEntries(new FormData(this.form)),offset:this.offset};if(JSON.stringify(t)===JSON.stringify(this.query))return;this.query=t,this.loader.classList.remove("hidden"),this.more.classList.add("hidden");const s=await fetch("/api/search",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.query)});if(!s.ok)return;const{results:r,total:i,offset:o,limit:a}=await s.json();this.loader.classList.add("hidden"),this.empty.classList[0===i?"remove":"add"]("hidden"),this.more.classList[i>o+a?"remove":"add"]("hidden"),this.offset+=a}}document.addEventListener("DOMContentLoaded",(()=>new VideoSearch));